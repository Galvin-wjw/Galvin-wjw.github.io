# 时间戳防盗链 
---

###一.防盗链格式    

`http://qn.vod.ottauto.cp59.ott.cibntv.net/20170921/1300/ZLYC001.mp4?timestamp=20180820165627&encrypt=cb37c91f526c5308682fea75b864657c`      

###二.防盗链字段描述    

|序号 |字段 |参数 |描述|    
|---:|---:|---:|---:|
|1|KEY|ygYU4r7YfDcgdUJ4|双方约定的秘钥|   
|2|URI|/20170921/1300/ZLYC001.mp4|除域名外的URL部分，不包含反斜杠 | |3|TIME|20180820165627|当前请求时间格式为：yyyyMMddHHmmss|    
|4|SIGN|md5(URI+"?timestamp="+TIME+KEY)|计算出来的md5值 | 

###三.测试URL 

`http://qn.vod.ottauto.cp59.ott.cibntv.net/20170921/1300/ZLYC001.mp4`

###四.防盗链针对的文件类型
 - 目前我们只有MP4  
 - 点播加速时，源站如有flash跨域策略文件crossdomain.xml，必须对xml文件类型不做防盗链配制   
 - 图片加速时，源站如有css和js等元素，必须对此类文件类型不做防盗链配制           

###五.防盗链过期时间
 - 防盗链的过期时间暂时定一个小时，然后通过代码可以调整过期时间          

###六.防盗链缓存方式

 - 去问号缓存

###七.防盗链回源方式
 - 回源方式是带防盗链回源   

###八.防盗链是否区分大小写
 - 防盗链按照代码规则都小写
